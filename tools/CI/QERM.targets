<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    
    <!-- BinScope properties and targets -->
    <PropertyGroup>
        <BinScopeOutDir Condition="'$(BinScopeOutDir)' == ''">$(OutputPath)BinScope\</BinScopeOutDir>
        <BinScopeTargetDir Condition="'$(BinScopeTarget)' == ''">$(IntermediateOutputPath)BinScope\</BinScopeTargetDir>
        <BinScopeLogFile Condition="'$(BinScopeLogFile)' == ''">$(BinScopeOutDir)BinScopeResults.xml</BinScopeLogFile>

        <BinScope61BetaInstallDir>$(MSBuildProgramFiles32)\Microsoft\BinScope for SDL 6.1 (Beta)\</BinScope61BetaInstallDir>
        <BinScope61InstallDir>$(MSBuildProgramFiles32)\Microsoft\BinScope for SDL 6.1\</BinScope61InstallDir>

        <!-- If nothing is defined, we will assume that it's the 6.1 Beta release. -->
        <BinScopeInstallDir Condition="('$(BinScopeInstallerDir)' == '') And (Exists('$(BinScope61BetaInstallDir)')) ">$(BinScope61BetaInstallDir)</BinScopeInstallDir>
        <BinScopeInstallDir Condition="('$(BinScopeInstallerDir)' == '') And (Exists('$(BinScope61InstallDir)'))">$(BinScope61InstallDir)</BinScopeInstallDir>
        <BinScopeEXE Condition="'$(BinScopeEXE)' == ''">$(BinScopeInstallDir)BinScope.EXE</BinScopeEXE>

        <BinScopeSymbolOption Condition="'$(BinScopeSymPath)' != ''">/sympath $(BinScopeSymPath)</BinScopeSymbolOption>
    </PropertyGroup>

    <Target Name="BinScope">
        <RemoveDir Directories="$(BinScopeTargetDir)" />
        <MakeDir Directories="$(BinScopeTargetDir)" />

        <Copy SourceFiles="@(BinScopeTargetFiles)" DestinationFiles="@(BinScopeTargetFiles->'$(BinScopeTargetDir)%(RecursiveDir)\%(Filename)%(Extension)')" />

        <Exec Command="&quot;$(BinScopeEXE)&quot; /target $(BinScopeTargetDir) $(BinScopeSymbolOption) /logfile $(BinScopeLogFile)" />
    </Target>
</Project>